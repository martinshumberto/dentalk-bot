<template>
  <div 
    :data-background-color="backgroundColor"
    :data-active-color="activeColor"
    class="sidebar">
    <div 
      id="style-3" 
      class="sidebar-wrapper">
      <div class="logo">
        <a 
          href="#" 
          class="simple-text">
          <div class="logo-img">
            <svg 
              viewBox="0 0 649.05 143.27" 
              xmlns="http://www.w3.org/2000/svg"><g><path d="m72.75 137.92q-10.41 5.31-25.84 5.31a50.05 50.05 0 0 1 -20.91-4.23 43.39 43.39 0 0 1 -15.49-11.5 44 44 0 0 1 -8.81-17 50.63 50.63 0 0 1 -1.13-20.74l.05-.38a60.11 60.11 0 0 1 7-20.85 65.29 65.29 0 0 1 13.59-17.18 63 63 0 0 1 18.72-11.58 59.61 59.61 0 0 1 22.5-4.25q14.67 0 23.67 4.63a44.68 44.68 0 0 1 15.2 12.74l-20.66 19.31a39.17 39.17 0 0 0 -9.17-8.3q-4.87-3.09-12.79-3.09a24.76 24.76 0 0 0 -10.44 2.19 30.43 30.43 0 0 0 -8.77 6.08 33.18 33.18 0 0 0 -6.47 9 35 35 0 0 0 -3.37 10.92l-.06.39a32 32 0 0 0 .27 11.19 22.25 22.25 0 0 0 4 9.07 20.47 20.47 0 0 0 7.45 6.09 23.45 23.45 0 0 0 10.52 2.26 28.93 28.93 0 0 0 13.26-3 65.42 65.42 0 0 0 12-8l14.74 17.38a80.58 80.58 0 0 1 -19.06 13.54z"/><path d="m202.1 110.32a65.2 65.2 0 0 1 -14.17 17.08 67.14 67.14 0 0 1 -19.39 11.6 62.41 62.41 0 0 1 -23 4.24 54.13 54.13 0 0 1 -21.62-4.15 44.6 44.6 0 0 1 -16.06-11.39 43.94 43.94 0 0 1 -9.29-17 49.09 49.09 0 0 1 -1.3-20.95v-.38a57.73 57.73 0 0 1 7.19-20.95 65 65 0 0 1 14.24-17.07 67.07 67.07 0 0 1 19.39-11.58 62.37 62.37 0 0 1 23-4.25 54.13 54.13 0 0 1 21.62 4.15 44.72 44.72 0 0 1 16.06 11.39 44 44 0 0 1 9.29 17 49.05 49.05 0 0 1 1.29 20.94l-.06.39a57.75 57.75 0 0 1 -7.19 20.93zm-21.76-20.94a29.53 29.53 0 0 0 -.4-10.91 23.18 23.18 0 0 0 -4.32-9.07 22.49 22.49 0 0 0 -7.81-6.28 23.88 23.88 0 0 0 -10.68-2.31 29.43 29.43 0 0 0 -11.6 2.19 30.2 30.2 0 0 0 -9.25 6.08 32.26 32.26 0 0 0 -6.57 9 35 35 0 0 0 -3.37 10.92v.39a29.07 29.07 0 0 0 .39 10.9 23.1 23.1 0 0 0 4.33 9.08 22.69 22.69 0 0 0 7.71 6.27 23.67 23.67 0 0 0 10.72 2.36 29.4 29.4 0 0 0 11.6-2.22 30.27 30.27 0 0 0 9.26-6.09 32.43 32.43 0 0 0 6.56-9 35 35 0 0 0 3.37-10.91z"/><path d="m275.21 143.27 8.09-58.86q1.45-10.64-2.43-16t-12.38-5.41a19.72 19.72 0 0 0 -14.16 5.41q-5.67 5.42-7.13 16l-8.09 58.86h-29.34l14.54-105.78h29.34l-2.08 15.12a79.4 79.4 0 0 1 6.43-6.46 47.51 47.51 0 0 1 7.41-5.46 38.22 38.22 0 0 1 8.59-3.78 35.35 35.35 0 0 1 10.23-1.39q16.77 0 24.52 10.48t5.25 28.79l-9.41 68.48z"/><path d="m391.7 124.41a33.62 33.62 0 0 1 -9.84 10.33 44.59 44.59 0 0 1 -13.5 6.08 60.67 60.67 0 0 1 -15.83 2 67.26 67.26 0 0 1 -22-3.77 60.47 60.47 0 0 1 -20.24-11.87l15.26-19.3a58.05 58.05 0 0 0 15.59 9.26 42.25 42.25 0 0 0 15.3 3.09c4.25 0 7.46-.7 9.66-2.12a7.82 7.82 0 0 0 3.78-5.6l.05-.39a4.9 4.9 0 0 0 -1.16-4.05 12.16 12.16 0 0 0 -4.31-3 59.46 59.46 0 0 0 -6.46-2.37c-2.46-.78-5.05-1.61-7.75-2.51a96.18 96.18 0 0 1 -10.38-3.77 32.56 32.56 0 0 1 -9.13-5.79 23.19 23.19 0 0 1 -6-8.78q-2.07-5.22-1-12.74l.05-.39a35.12 35.12 0 0 1 5-14 38.16 38.16 0 0 1 9.56-10.33 41 41 0 0 1 12.8-6.39 52.41 52.41 0 0 1 15.06-2.13 64.56 64.56 0 0 1 36.93 12l-14.05 20.27a77.91 77.91 0 0 0 -14.06-7 36.32 36.32 0 0 0 -12.57-2.61c-3.61 0-6.4.68-8.39 2a7.3 7.3 0 0 0 -3.43 5.11l-.05.39a4.39 4.39 0 0 0 1.21 3.76 15.45 15.45 0 0 0 4.2 3.09 51.33 51.33 0 0 0 6.26 2.8c2.39.9 4.93 1.8 7.64 2.7a109.41 109.41 0 0 1 10.41 4.15 37.58 37.58 0 0 1 9.22 5.89 24 24 0 0 1 6.14 8.49q2.19 5 1.18 12.17l-.05.38a38.11 38.11 0 0 1 -5.1 14.95z"/><path d="m401.26 143.27 14.54-105.2h29.34l-14.54 105.2zm15.37-116.77 3.66-26.5h30.89l-3.67 26.5z"/><path d="m490.82 143.27 14.54-105.2h29.34l-14.54 105.2zm15.37-116.77 3.66-26.5h30.89l-3.66 26.5z"/><path d="m641.25 110.32a65.24 65.24 0 0 1 -14.18 17.08 67.14 67.14 0 0 1 -19.39 11.6 62.41 62.41 0 0 1 -23 4.24 54.08 54.08 0 0 1 -21.61-4.15 44.43 44.43 0 0 1 -16.07-11.4 44 44 0 0 1 -9.3-17 49.25 49.25 0 0 1 -1.3-20.95l.06-.38a57.36 57.36 0 0 1 7.19-20.95 65.2 65.2 0 0 1 14.17-17.08 67.34 67.34 0 0 1 19.39-11.58 62.42 62.42 0 0 1 23-4.25 54.08 54.08 0 0 1 21.61 4.15 44.76 44.76 0 0 1 16.08 11.41 44.11 44.11 0 0 1 9.29 17 49.21 49.21 0 0 1 1.3 20.94v.39a57.75 57.75 0 0 1 -7.24 20.93zm-21.77-20.94a29.32 29.32 0 0 0 -.4-10.91 23.18 23.18 0 0 0 -4.32-9.07 22.45 22.45 0 0 0 -7.8-6.28 23.88 23.88 0 0 0 -10.68-2.31 29.45 29.45 0 0 0 -11.61 2.19 30.2 30.2 0 0 0 -9.25 6.08 32.26 32.26 0 0 0 -6.57 9 35.23 35.23 0 0 0 -3.36 10.92l-.06.39a29.27 29.27 0 0 0 .4 10.9 23.08 23.08 0 0 0 4.32 9.08 22.78 22.78 0 0 0 7.71 6.27 23.67 23.67 0 0 0 10.77 2.36 29.45 29.45 0 0 0 11.61-2.22 30.22 30.22 0 0 0 9.25-6.09 32.26 32.26 0 0 0 6.57-9 35.52 35.52 0 0 0 3.37-10.91z"/></g><path d="m496.3 0-14.54 105.2h-29.34l14.58-105.2zm-15.37 116.78-3.66 26.49h-30.88l3.66-26.49z" /></svg>
          </div>
        </a>
      </div>
      <slot/>
      <ul class="nav">
        <slot name="links">
          <sidebar-link 
            v-for="(link,index) in sidebarLinks"
            :key="index"
            :to="link.path"
            :name="link.name"
            :icon="link.icon"/>
        </slot>
      </ul>
      <moving-arrow :move-y="arrowMovePx"/>
    </div>
  </div>
</template>
<script>
import MovingArrow from './MovingArrow.vue';
import SidebarLink from './SidebarLink';
export default {
    components: {
        MovingArrow,
        SidebarLink
    },
    props: {
        title: {
            type: String,
            default: 'Dentalk'
        },
        backgroundColor: {
            type: String,
            default: 'white',
            validator: value => {
                let acceptedValues = ['white', 'black', 'darkblue'];
                return acceptedValues.indexOf(value) !== -1;
            }
        },
        activeColor: {
            type: String,
            default: 'default',
            validator: value => {
                let acceptedValues = [
                    'primary',
                    'info',
                    'success',
                    'warning',
                    'danger',
                    'default'
                ];
                return acceptedValues.indexOf(value) !== -1;
            }
        },
        sidebarLinks: {
            type: Array,
            default: () => []
        },
        autoClose: {
            type: Boolean,
            default: true
        }
    },
    provide() {
        return {
            autoClose: this.autoClose,
            addLink: this.addLink,
            removeLink: this.removeLink
        };
    },
    data() {
        return {
            linkHeight: 65,
            activeLinkIndex: 0,
            windowWidth: 0,
            isWindows: false,
            hasAutoHeight: false,
            links: []
        };
    },
    computed: {
    /**
     * Styles to animate the arrow near the current active sidebar link
     * @returns {{transform: string}}
     */
        arrowMovePx() {
            return this.linkHeight * this.activeLinkIndex;
        }
    },
    mounted() {
        this.$watch('$route', this.findActiveLink, {
            immediate: true
        });
    },
    methods: {
        findActiveLink() {
            this.links.forEach((link) => {
                if (link.isActive()) {
                    this.activeLinkIndex = 'index';
                }
            });
        },
        addLink(link) {
            const index = this.$slots.links.indexOf(link.$vnode);
            this.links.splice(index, 0, link);
        },
        removeLink(link) {
            const index = this.links.indexOf(link);
            if (index > -1) {
                this.links.splice(index, 1);
            }
        }
    },
};
</script>
<style>
</style>
